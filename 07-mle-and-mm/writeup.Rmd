---
title: "MLE and MM"
output: html_document
---

### Donald Kane
### November 8, 2021


```{r}
require(dplyr)
Hmisc::getHdata(nhgh)
d1 <- nhgh %>% 
  filter(sex == "female") %>% 
  filter(age >= 18) %>% 
  select(gh, ht) %>% 
  filter(1:n()<=1000)

gly <- d1$gh
ht <- d1$ht
```

# Glycohemoglobin

## Nomral Distribution

### Estimates of paramters

```{r}
# Method of Moments
xbar <- mean(gly)
xbar
stdev <- sd(gly)
stdev
```

### Overlay Estimated PDF onto Histogram

```{r}
# Method of Moments
fglyn <- function(x){
  dnorm(x, xbar, stdev)
}
hist(gly,
     freq = FALSE,
     main = "Normal Glycohemoglobin MM",
     breaks = 50)
curve(fglyn(x),
      add = TRUE,
      col = "red",
      lwd = 3,
      main = "Normal Glycohemoglobin MM")

# Maximum Likelihood
#hist(gly, freq = FALSE, main = "")
#curve(
 #   dnorm(x, coef(fit)[1], coef(fit)[2])
  #, add = TRUE
  #, col = "green"
  #, lwd = 3
#)

```

### Overlay Estimated CDF onto ECDF

```{r}
# Method of Moments
Fglyn <- function(x){
  pnorm(x, xbar, stdev)
}
plot(ecdf(gly),
     main = "Normal Glycohemoglobin MM")
curve(Fglyn(x),
      add = TRUE,
      col = "red",
      lwd = 3,
      main = "Normal Glycohemoglobin MM")

# Maximum Likelihood
#plot(ecdf(gly), main = "")
#curve(
#    pnorm(x, coef(fit)[1], coef(fit)[2])
#  , add = TRUE
#  , col = "green"
#  , lwd = 3
#)
```

### QQ Plot

```{r}
###
#U <- rnorm(1000)
#Y <- qnorm(U, xbar, stdev)
#ps <- ppoints(1000)
#theoretical <- qnorm(ps, xbar, stdev)
#sample <- quantile(Y, ps)
#plot(theoretical, sample)
#abline(0,1)
#qnorm(U, xbar, stdev)

```

### Estimated Median

```{r}

```

# Gamma Distribution

### Estimates of paramters

```{r}
xbar <- mean(gly)
s2 <- var(gly)

shape_hat <- xbar^2/s2
shape_hat
scale_hat <- s2/xbar
scale_hat
```

### Overlay Estimated PDF onto Histogram

```{r}
# Method of Moments
fglyg <- function(x){
  dgamma(x,
         shape = shape_hat,
         scale = scale_hat)
}

hist(gly,
     freq = FALSE,
     main = "Gamma Glycohemoglobin MM",
     breaks = 75)
curve(fglyg(x),
      add = TRUE,
      col = "red",
      lwd = 3,
      main = "Gamma Glycohemoglobin MM")


# Maximum Likelihood
#hist(gly, freq = FALSE, main = "")
#curve(
#    dgamma(x, coef(fit)[1], coef(fit)[2])
#  , add = TRUE
#  , col = "green"
#  , lwd = 3
#)
```

### Overlay Estimated CDF onto ECDF

```{r}
# Method of Moments
Fglyg <- function(x){
  pgamma(x,
         shape = shape_hat,
         scale = scale_hat)
}

plot(ecdf(gly),
     main = "Gamma Glycohemoglobin MM")
curve(Fglyg(x),
      add = TRUE,
      col = "red",
      lwd = 3,
      main = "Gamma Glycohemoglobin MM")

# Maximum Likelihood
#plot(ecdf(bmi), main = "")
#curve(
#    pgamma(x, coef(fit)[1], coef(fit)[2])
#  , add = TRUE
#  , col = "green"
#  , lwd = 3
#)
```

### QQ Plot

```{r}

```

### Estimated Median

```{r}

```

# Weibull Distribution

### Estimates of paramters

```{r}
xbar <- mean(gly)
s2 <- var(gly)

shape_hat <- xbar^2/s2
shape_hat
scale_hat <- s2/xbar
scale_hat
```

### Overlay Estimated PDF onto Histogram

```{r}
# Method of Moments
fglyw <- function(x){
  dweibull(x,
         shape = shape_hat,
         scale = scale_hat)
}

hist(gly,
     freq = FALSE,
     main = "Gamma Glycohemoglobin MM",
     breaks = 75)
curve(fglyg(x),
      add = TRUE,
      col = "red",
      lwd = 3,
      main = "Gamma Glycohemoglobin MM")

```

### Overlay Estimated CDF onto ECDF

```{r}
Fglyw <- function(x){
  pweibull(x,
         shape = shape_hat,
         scale = scale_hat)
}

plot(ecdf(gly),
     main = "Gamma Glycohemoglobin MM")
curve(Fglyg(x),
      add = TRUE,
      col = "red",
      lwd = 3,
      main = "Gamma Glycohemoglobin MM")
```

### QQ Plot

```{r}

```

### Estimated Median

```{r}

```

# Height




















